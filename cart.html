<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Carrito — Thrift Cálido Bazar</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <style>
    body { background-color:#f8fafc; }
    .btn-burly { background-color: burlywood; color: #fff; }
    .btn-burly:hover { filter: brightness(0.9); color: #fff; }
    .table thead th { background:#0f172a; color:#fff; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
    <a class="navbar-brand d-flex align-items-center" href="index.html">
      <i class="bi bi-shop me-2" style="color: burlywood; font-size:1.4rem"></i>
      <span style="color: burlywood; font-weight: bold;">Thrift Cálido Bazar</span>
    </a>
    <div class="ms-auto d-flex gap-2 flex-wrap">
      <a href="index.html" class="btn btn-sm btn-burly">Inicio</a>
      <a href="catalog.html" class="btn btn-sm btn-burly">Catálogo</a>
      <a href="cart.html" class="btn btn-sm btn-burly active">Carrito</a>
      <a href="pago.html" class="btn btn-sm btn-burly">Pago</a>
      <a href="metodos.html" class="btn btn-sm btn-outline-light">Métodos de pago</a>
      <span id="navUserName" class="text-white-50 small ms-2"></span>
      <button class="btn btn-sm btn-outline-light" onclick="cerrarSesion()">
        <i class="bi bi-box-arrow-right"></i> Cerrar sesión
      </button>
    </div>
  </nav>

  <div class="container my-5">

    <!-- Carrito -->
    <h1 class="text-center fw-bold" style="color: burlywood;">Carrito de compras</h1>
    <div class="table-responsive mt-4">
      <table class="table align-middle">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Precio</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody id="cart-body"></tbody>
        <tfoot>
          <tr>
            <th colspan="3" class="text-end">Total:</th>
            <th id="cart-total">$0</th>
          </tr>
        </tfoot>
      </table>
    </div>
    <div class="text-end">
      <button class="btn btn-outline-danger me-2" id="clearCart">Vaciar carrito</button>
      <button class="btn btn-burly" id="goPay">Continuar a pago</button>
    </div>

    <!-- Términos de compra y devolución -->
    <section class="mt-5">
      <h2 class="h4 fw-bold" style="color: burlywood;">Términos de compra y devoluciones</h2>
      <p class="text-muted">
        Al finalizar tu compra en Thrift Cálido Bazar aceptas las siguientes condiciones:
      </p>
      <ul>
        <li>Las prendas son de <strong>segunda mano</strong> y pueden presentar ligeros detalles de uso.</li>
        <li>Las fotografías son referenciales; puede haber variaciones mínimas de color según la pantalla.</li>
        <li>Se recomienda <strong>lavar la prenda antes de usarla</strong> por primera vez, por higiene y conservación.</li>
        <li><strong>No hay devoluciones ni cambios</strong>, ya que se trata de piezas únicas de segunda mano.</li>
        <li>Solo se aceptará aclaración cuando la prenda recibida <strong>no corresponda</strong> a la que se pidió
          (modelo, talla o descripción claramente distinta).</li>
      </ul>
      <p class="text-muted small mb-0">
        Cualquier duda sobre tu pedido la puedes enviar a <strong>thriftcalido@gmail.com</strong> o por WhatsApp.
      </p>
    </section>

  </div>
 <div class="modal fade" id="avisoModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Aviso de Privacidad</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <p>
              En <strong>Thrift Cálido Bazar</strong> valoramos la privacidad de nuestros clientes y 
              nos comprometemos a proteger su información personal. Los datos proporcionados 
              (nombre, correo electrónico, teléfono) se utilizan exclusivamente para dar 
              seguimiento a sus consultas, pedidos o promociones relacionadas con nuestra tienda.
            </p>
            <p>
              No compartimos información personal con terceros sin consentimiento, salvo que 
              sea requerido por ley. El usuario puede ejercer sus derechos ARCO (Acceso, 
              Rectificación, Cancelación y Oposición) contactándonos a 
              <a href="mailto:thriftcalido@gmail.com">thriftcalido@gmail.com</a>.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Términos y Condiciones -->
<div class="modal fade" id="terminosModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Términos y Condiciones</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">

        <p>
          El uso del sitio web de <strong>Thrift Cálido Bazar</strong> implica la aceptación de los siguientes
          términos, políticas y condiciones aplicables a la venta de prendas de segunda mano.
        </p>

        <h5 class="mt-3">1. Naturaleza del producto</h5>
        <ul>
          <li>Las prendas ofrecidas son <strong>de segunda mano</strong>.</li>
          <li>Pueden presentar <strong>ligeros detalles propios del uso</strong>, como desgaste menor, fibras sueltas o variaciones en color.</li>
          <li>Las fotografías muestran el estado general de la prenda, pero pueden existir <strong>otros detalles no visibles</strong> o difíciles de capturar en imagen.</li>
          <li>Recomendamos <strong>lavar la prenda antes de su primer uso</strong> por higiene y conservación.</li>
        </ul>

        <h5 class="mt-3">2. Disponibilidad</h5>
        <ul>
          <li>El inventario está sujeto a disponibilidad; cada prenda es única.</li>
          <li>Las imágenes son representativas y pueden variar levemente.</li>
        </ul>

        <h5 class="mt-3">3. Compras y pedidos</h5>
        <ul>
          <li>El cliente se compromete a proporcionar información verídica al realizar un pedido.</li>
          <li>El sistema genera un <strong>folio de compra.
        </ul>

        <h5 class="mt-3">4. Cambios, devoluciones y garantías</h5>
        <ul>
          <li>No se aceptan devoluciones por <strong>cambio de opinión</strong> debido a que cada prenda es única.</li>
          <li>Sólo se considerará una devolución en caso de que la prenda recibida no coincida con la descrita.</li>
          <li>No aplican garantías sobre prendas de segunda mano.</li>
        </ul>

        <h5 class="mt-3">5. Envíos</h5>
        <ul>
          <li>Todos los envios se realizan por correos de mexico.</li>
          <li>Thrift Calido no se hace responsable de los daños que se causen durante el envio.</li>
        </ul>

        <h5 class="mt-3">6. Responsabilidad del usuario</h5>
        <ul>
          <li>El cliente es responsable del uso, cuidado y lavado de la prenda.</li>
          <li>Thrift Cálido Bazar no se hace responsable por daños ocasionados por uso inadecuado o mal lavado.</li>
        </ul>

        <h5 class="mt-3">7. Datos personales</h5>
        <ul>
          <li>Los datos proporcionados se manejan de acuerdo con nuestro <strong>Aviso de Privacidad</strong>.</li>
          <li>El usuario puede solicitar acceso, corrección o eliminación de sus datos enviando correo a: 
            <a href="mailto:thriftcalido@gmail.com">thriftcalido@gmail.com</a>.
          </li>
        </ul>

        <p class="mt-3">
          Para más información, contáctanos por correo electrónico o vía WhatsApp al 
          <a href="https://wa.me/524491851273" target="_blank">449 185 1273</a>.
        </p>

      </div>
    </div>
  </div>
</div>

    <!-- Footer -->
    <footer class="bg-dark text-center text-white py-3 mt-5">
      <p class="mb-1">
        <span style="color: burlywood; font-weight: bold;">&copy; 2025 Thrift Cálido Bazar</span> - Todos los derechos reservados
      </p>
      <a href="#" class="text-white me-3" data-bs-toggle="modal" data-bs-target="#avisoModal">Aviso de Privacidad</a>
      <a href="#" class="text-white" data-bs-toggle="modal" data-bs-target="#terminosModal">Términos y Condiciones</a>
    </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const CART_KEY = "thrift_cart";

    // Verificar rol para acceso de usuario
    const rol = localStorage.getItem("rol");
    if (!rol) {
      alert("Debes iniciar sesión primero.");
      window.location.href = "login.html";
    } else if (rol !== "usuario") {
      alert("Acceso restringido: solo usuarios.");
      window.location.href = "views/admin.html";
    }

    let PRODUCTS = [];

    function loadCart(){ return JSON.parse(localStorage.getItem(CART_KEY)||"{}"); }
    function saveCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); }

    function renderCart(){
      const cart = loadCart();
      const body = document.getElementById('cart-body');
      body.innerHTML = '';
      let total=0;
      Object.entries(cart).forEach(([id,qty])=>{
        const p = PRODUCTS.find(x => x.id === id);
        if (!p) return;
        const subtotal = p.precio * qty;
        total += subtotal;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.nombre}</td>
          <td>${qty}</td>
          <td>$${p.precio.toFixed(2)}</td>
          <td>$${subtotal.toFixed(2)}</td>
        `;
        body.appendChild(tr);
      });
      document.getElementById('cart-total').textContent = '$'+total.toFixed(2);
    }

    function cerrarSesion(){
      localStorage.removeItem('rol');
      window.location.href = 'login.html';
    }
    window.cerrarSesion = cerrarSesion;

    document.getElementById('clearCart').onclick = ()=>{
      saveCart({});
      renderCart();
    };

    document.getElementById('goPay').onclick = ()=>{
      const cart = loadCart();
      if (!cart || Object.keys(cart).length === 0) {
        alert("Tu carrito está vacío.");
        return;
      }
      window.location.href = 'pago.html';
    };

    // Cargar productos y renderizar carrito
    fetch('src/data/products.json')
      .then(r => r.json())
      .then(data => {
        PRODUCTS = data;
        renderCart();
      });
  </script>
  <script src="src/js/navbar-role.js"></script>

</body>
</html>
